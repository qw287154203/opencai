!function(e){function t(a){var i,u=this,c=a.data||{};if(c.elem)u=a.dragTarget=c.elem,a.dragProxy=s.proxy||u,a.cursorOffsetX=c.pageX-c.left,a.cursorOffsetY=c.pageY-c.top,a.offsetX=a.pageX-a.cursorOffsetX,a.offsetY=a.pageY-a.cursorOffsetY;else if(s.dragging||c.which>0&&a.which!=c.which||e(a.target).is(c.not))return;switch(a.type){case"mousedown":return e.extend(c,e(u).offset(),{elem:u,target:a.target,pageX:a.pageX,pageY:a.pageY}),o.add(document,"mousemove mouseup",t,c),g(u,!1),s.dragging=null,!1;case!s.dragging&&"mousemove":if(n(a.pageX-c.pageX)+n(a.pageY-c.pageY)<c.distance)break;a.target=c.target,!1!==(i=r(a,"dragstart",u))&&(s.dragging=u,s.proxy=a.dragProxy=e(i||u)[0]);case"mousemove":if(s.dragging){if(i=r(a,"drag",u),d.drop&&(d.drop.allowed=!1!==i,d.drop.handler(a)),!1!==i)break;a.type="mouseup"}case"mouseup":o.remove(document,"mousemove mouseup",t),s.dragging&&(d.drop&&d.drop.handler(a),r(a,"dragend",u)),g(u,!0),s.dragging=s.proxy=c.elem=!1}return!0}function r(t,r,n){t.type=r;var a=e.event.handle.call(n,t);return!1!==a&&(a||t.result)}function n(e){return Math.pow(e,2)}function a(){return!1===s.dragging}function g(e,t){e&&(e.unselectable=t?"off":"on",e.onselectstart=function(){return t},e.style&&(e.style.MozUserSelect=t?"":"none"))}e.fn.drag=function(e,t,r){return t&&this.bind("dragstart",e),r&&this.bind("dragend",r),e?this.bind("drag",t||e):this.trigger("drag")};var o=e.event,d=o.special,s=d.drag={not:":input",distance:0,which:1,dragging:!1,setup:function(r){(r=e.extend({distance:s.distance,which:s.which,not:s.not},r||{})).distance=n(r.distance),o.add(this,"mousedown",t,r),this.attachEvent&&this.attachEvent("ondragstart",a)},teardown:function(){o.remove(this,"mousedown",t),this===s.dragging&&(s.dragging=s.proxy=!1),g(this,!0),this.detachEvent&&this.detachEvent("ondragstart",a)}};d.dragstart=d.dragend={setup:function(){},teardown:function(){}}}(jQuery);